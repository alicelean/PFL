/Users/alice/opt/anaconda3/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: 'dlopen(/Users/alice/opt/anaconda3/lib/python3.8/site-packages/torchvision/image.so, 6): Library not loaded: @rpath/libpng16.16.dylib
  Referenced from: /Users/alice/opt/anaconda3/lib/python3.8/site-packages/torchvision/image.so
  Reason: Incompatible library version: image.so requires version 56.0.0 or later, but libpng16.16.dylib provides version 54.0.0'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/Users/alice/Desktop/python/PFL/system /Users/alice/Desktop/python/PFL
/Users/alice/Desktop/python/PFL/system /Users/alice/Desktop/python/PFL
/Users/alice/Desktop/python/PFL/system /Users/alice/Desktop/python/PFL

cuda is not avaiable.

==================================================
Algorithm: FedAvg
Local batch size: 10
Local steps: 1
Local learing rate: 0.005
Local learing rate decay: False
Total number of clients: 20
Clients join in each round: 0.5
Clients randomly join: False
Client drop rate: 0.0
Client select regarding time: False
Running times: 1
Dataset: mnist
Number of classes: 10
Backbone: cnn
Using device: cpu
Using DP: False
Auto break: False
Global rounds: 1
DLG attack: False
Total number of new clients: 0
Fine tuning epoches on new clients: 0
==================================================

============= Running time: 0th =============
Creating server and clients ...
FedAvgCNN(
  (conv1): Sequential(
    (0): Conv2d(1, 32, kernel_size=(5, 5), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  )
  (conv2): Sequential(
    (0): Conv2d(32, 64, kernel_size=(5, 5), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  )
  (fc1): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU(inplace=True)
  )
  (fc): Linear(in_features=512, out_features=10, bias=True)
)
INFO:------------------------args.algorithm is:FedAvg-----------------------
**************************1.INfo,set_clients ,init data********************

Join ratio / total clients: 0.5 / 20
Finished creating server and clients.
-------------------------------------------------------------------------write exe canshu,txt path is /Users/alice/Desktop/python/PFL//res/FedAvg/mnist_canshu.csv

-------------Round number: 0---Evaluate global model----------
Averaged Train Loss: 2.3127
Averaged Test Accurancy: 0.0608
Averaged Test AUC: 0.4337
Std Test Accurancy: 0.0671
Std Test AUC: 0.1842
------------------------- time cost ------------------------- 53.89189696311951

-------------Round number: 1---Evaluate global model----------
Averaged Train Loss: 2.4088
Averaged Test Accurancy: 0.1086
Averaged Test AUC: 0.5212
Std Test Accurancy: 0.2209
Std Test AUC: 0.2845
------------------------- time cost ------------------------- 57.67007398605347

Best accuracy.
0.10857893534384282

Average time cost per round.
57.67007398605347
write select id list  /Users/alice/Desktop/python/PFL//res/selectids/mnist_select_client_ids20_0.5.csv
success training write acc txt /Users/alice/Desktop/python/PFL//res/FedAvg/mnist_acc.csv
[['mnist', 'FedAvg', 0, 2.3126724922475015, 0.060829335161069226, 0.4336906327316577, 0.06708057149762552, 0.18417894575936128], ['mnist', 'FedAvg', 1, 2.4088350149056383, 0.10857893534384282, 0.5211602672304623, 0.22089594954504374, 0.28447197061921314]]
File path: ../results/mnist_FedAvg_test_0.h5

Average time cost: 113.57s.
Length:  2
std for best accurancy: 0.0
mean for best accurancy: 0.10857893534384282
All done!

Storage on cpu
-------------------------------------------------------------------------------
Total Tensors: 140165352 	Used Memory: 292.10M
-------------------------------------------------------------------------------

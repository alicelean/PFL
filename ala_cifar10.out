/Users/alice/opt/anaconda3/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: 'dlopen(/Users/alice/opt/anaconda3/lib/python3.8/site-packages/torchvision/image.so, 6): Library not loaded: @rpath/libpng16.16.dylib
  Referenced from: /Users/alice/opt/anaconda3/lib/python3.8/site-packages/torchvision/image.so
  Reason: Incompatible library version: image.so requires version 56.0.0 or later, but libpng16.16.dylib provides version 54.0.0'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/Users/alice/Desktop/python/PFL/system /Users/alice/Desktop/python/PFL
/Users/alice/Desktop/python/PFL/system /Users/alice/Desktop/python/PFL
2023-06-12 21:33:14.303713: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
/Users/alice/Desktop/python/PFL/system /Users/alice/Desktop/python/PFL

cuda is not avaiable.

==================================================
Algorithm: FedALA
Local batch size: 10
Local steps: 1
Local learing rate: 0.005
Local learing rate decay: False
Total number of clients: 20
Clients join in each round: 0.5
Clients randomly join: False
Client drop rate: 0.0
Client select regarding time: False
Running times: 1
Dataset: Cifar10
Number of classes: 10
Backbone: cnn
Using device: cpu
Using DP: False
Auto break: False
Global rounds: 10
DLG attack: False
Total number of new clients: 0
Fine tuning epoches on new clients: 0
==================================================

============= Running time: 0th =============
Creating server and clients ...
FedAvgCNN(
  (conv1): Sequential(
    (0): Conv2d(3, 32, kernel_size=(5, 5), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  )
  (conv2): Sequential(
    (0): Conv2d(32, 64, kernel_size=(5, 5), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  )
  (fc1): Sequential(
    (0): Linear(in_features=1600, out_features=512, bias=True)
    (1): ReLU(inplace=True)
  )
  (fc): Linear(in_features=512, out_features=10, bias=True)
)
INFO:------------------------args.algorithm is:FedALA-----------------------
**************************1.INfo,set_clients ,init data********************
client base client  0, total_num is 1621,label is [0, 9, 0, 668, 476, 287, 5, 167, 0, 9]
client base client  1, total_num is 1814,label is [7, 1, 62, 0, 43, 0, 0, 177, 1524, 0]
client base client  2, total_num is 1211,label is [0, 0, 16, 158, 1034, 3, 0, 0, 0, 0]
client base client  3, total_num is 2080,label is [0, 402, 12, 7, 0, 0, 1, 0, 1, 1657]
client base client  4, total_num is 5128,label is [24, 0, 5104, 0, 0, 0, 0, 0, 0, 0]
client base client  5, total_num is 4264,label is [2832, 0, 0, 1432, 0, 0, 0, 0, 0, 0]
client base client  6, total_num is 1440,label is [36, 0, 578, 708, 114, 0, 0, 0, 4, 0]
client base client  7, total_num is 2622,label is [0, 210, 2, 30, 962, 1, 0, 2, 0, 1415]
client base client  8, total_num is 2974,label is [0, 18, 0, 137, 11, 0, 0, 2568, 8, 232]
client base client  9, total_num is 3236,label is [2, 0, 0, 2511, 723, 0, 0, 0, 0, 0]
client base client  10, total_num is 1164,label is [454, 0, 2, 0, 0, 0, 0, 53, 655, 0]
client base client  11, total_num is 1964,label is [9, 744, 0, 7, 187, 5, 0, 93, 226, 693]
client base client  12, total_num is 5994,label is [248, 0, 2, 0, 360, 1802, 1, 0, 3581, 0]
client base client  13, total_num is 1527,label is [0, 21, 3, 237, 96, 1161, 0, 9, 0, 0]
client base client  14, total_num is 3100,label is [0, 16, 0, 0, 153, 1, 0, 2930, 0, 0]
client base client  15, total_num is 4325,label is [0, 1394, 157, 28, 18, 0, 735, 0, 0, 1993]
client base client  16, total_num is 4252,label is [2358, 9, 61, 2, 1822, 0, 0, 0, 0, 0]
client base client  17, total_num is 3175,label is [0, 3175, 0, 0, 0, 0, 0, 0, 0, 0]
client base client  18, total_num is 5449,label is [29, 0, 0, 74, 0, 89, 5257, 0, 0, 0]
client base client  19, total_num is 2660,label is [1, 1, 1, 1, 1, 2651, 1, 1, 1, 1]

Join ratio / total clients: 0.5 / 20
Finished creating server and clients.
-------------------------------------------------------------------------write exe canshu,txt path is /Users/alice/Desktop/python/PFL//res/FedALA/Cifar10_canshu.csv
 ALA at the 1st communication iteration
 ALA at the 1st communication iteration
 ALA at the 1st communication iteration
 ALA at the 1st communication iteration
 ALA at the 1st communication iteration
 ALA at the 1st communication iteration
 ALA at the 1st communication iteration
 ALA at the 1st communication iteration
 ALA at the 1st communication iteration
 ALA at the 1st communication iteration
 ALA at the 1st communication iteration
 ALA at the 1st communication iteration
 ALA at the 1st communication iteration
 ALA at the 1st communication iteration
 ALA at the 1st communication iteration
 ALA at the 1st communication iteration
 ALA at the 1st communication iteration
 ALA at the 1st communication iteration
 ALA at the 1st communication iteration
 ALA at the 1st communication iteration

-------------Round number: 0-------------

Evaluate global model
Averaged Train Loss: 2.3039
Averaged Test Accurancy: 0.0937
Averaged Test AUC: 0.4940
Std Test Accurancy: 0.1815
Std Test AUC: 0.2182
------------------------- time cost ------------------------- 139.71472811698914
Client: 0 	Std: 0.009308049309841014 	ALA epochs: 25
Client: 1 	Std: 0.009256188774865292 	ALA epochs: 22
Client: 2 	Std: 0.009318183702493746 	ALA epochs: 17
Client: 3 	Std: 0.009296894962412355 	ALA epochs: 27
Client: 4 	Std: 0.00993214282419018 	ALA epochs: 16
Client: 5 	Std: 0.00996769227315057 	ALA epochs: 16
Client: 6 	Std: 0.009955380360889532 	ALA epochs: 23
Client: 7 	Std: 0.009836747223285869 	ALA epochs: 29
Client: 8 	Std: 0.008880486647432408 	ALA epochs: 22
Client: 9 	Std: 0.009024609461653567 	ALA epochs: 18
Client: 10 	Std: 0.009701216662296449 	ALA epochs: 20
Client: 11 	Std: 0.009972696836605737 	ALA epochs: 26
Client: 12 	Std: 0.009264644679317948 	ALA epochs: 18
Client: 13 	Std: 0.009623741101908953 	ALA epochs: 17
Client: 14 	Std: 0.009516206043139123 	ALA epochs: 22
Client: 15 	Std: 0.00944387775744044 	ALA epochs: 21
Client: 16 	Std: 0.009962904993583715 	ALA epochs: 16
Client: 17 	Std: 0.009553720710633786 	ALA epochs: 20
Client: 18 	Std: 0.009965871427949956 	ALA epochs: 17
Client: 19 	Std: 0.009116134947641281 	ALA epochs: 21

-------------Round number: 1-------------

Evaluate global model
Averaged Train Loss: 1.5818
Averaged Test Accurancy: 0.5180
Averaged Test AUC: 0.7490
Std Test Accurancy: 0.3575
Std Test AUC: 0.2792
------------------------- time cost ------------------------- 789.3531198501587

-------------Round number: 2-------------

Evaluate global model
Averaged Train Loss: 1.0581
Averaged Test Accurancy: 0.6548
Averaged Test AUC: 0.8789
Std Test Accurancy: 0.3331
Std Test AUC: 0.2015
------------------------- time cost ------------------------- 176.80086708068848

-------------Round number: 3-------------

Evaluate global model
Averaged Train Loss: 0.7649
Averaged Test Accurancy: 0.7340
Averaged Test AUC: 0.9350
Std Test Accurancy: 0.2872
Std Test AUC: 0.1180
------------------------- time cost ------------------------- 219.3057780265808

-------------Round number: 4-------------

Evaluate global model
Averaged Train Loss: 0.6273
Averaged Test Accurancy: 0.7838
Averaged Test AUC: 0.9636
Std Test Accurancy: 0.2441
Std Test AUC: 0.0441
------------------------- time cost ------------------------- 34581.47744512558
------------Round number: 5-------------

Evaluate global model
Averaged Train Loss: 0.7075
Averaged Test Accurancy: 0.7686
Averaged Test AUC: 0.9325
Std Test Accurancy: 0.2272
Std Test AUC: 0.1396
------------------------- time cost ------------------------- 34589.40632891655

-------------Round number: 6-------------

Evaluate global model
